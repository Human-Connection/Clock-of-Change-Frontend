!function(e){var a={};function t(n){if(a[n])return a[n].exports;var r=a[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=a,t.d=function(e,a,n){t.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,a){if(1&a&&(e=t(e)),8&a)return e;if(4&a&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&a&&"string"!=typeof e)for(var r in e)t.d(n,r,function(a){return e[a]}.bind(null,r));return n},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},t.p="/",t(t.s=0)}([function(e,a){window.coc=function(e,a,t){var n={},r=t(".coc-form-overlay"),o="Ich bin für Veränderung.",c=t(".user-image"),s=t("#user-message"),i=0,l=null,u=!1,d=0,m=[];m.hair=0,m.eyebrow=0,m.eyes=0,m.nose=0,m.mouth=0,m.facialHair=0,m.clothing=0;var g=[];g.firstname="coc-firstname",g.lastname="coc-lastname",g.email="coc-email",g.message="coc-message",g.country="coc-country",g.anon="coc-anon",g.beta="coc-register-beta",g.nl="coc-register-nl",g.pr="coc-register-privacy",g.file="coc-add-avatar",g.error="form-error";var f=function(e){var r=t(this).data("message"),c=t(this).data("uname"),l=t(this).data("anon"),u=t(this).attr("src"),d=this.parentElement,m=t(this).data("country");i=function(e,a){var t,n=a.length;for(t=0;t<n;t++)if(a[t]===e)return t;return-1}(d,a.getElementsByClassName("user-item")),s.find(".user-message-image").attr("src",u),void 0!==l&&1===l&&(c="Mensch"),s.find(".message-name").text(c),""===r&&(r=o),s.find(".message-text").text(r),n.loadCountryFlagImage(m),s.show()};return n.ownImageChangeHandler=function(){var e=this;t("#ownImageUpload").on("change",(function(a){if(a.target.files&&a.target.files[0]){l=a.target.files;var n=new FileReader;n.onload=function(e){t("#coc-image").attr("src",e.target.result).width(200).height(200)},n.readAsDataURL(a.target.files[0]),u=!0}t(e).val("")})),t("#customUploadWrap").on("click",(function(e){t("#ownImageUpload").trigger("click"),u=!0,e.preventDefault()}))},n.init=function(){n.loadCountries(),t("#joinCoC").click((function(e){n.toggleForm(),e.preventDefault()})),t(".coc-form-close").click((function(){n.toggleForm()})),t("#joinNowBtn").click((function(a){a.preventDefault(),Object.values(g).forEach((function(e){t("#"+e)&&t("#"+e).removeClass("input-error")})),t(".form-error-hint").remove();var r=new FormData,o=t("#coc-email"),c=t("#coc-message"),s=t("#coc-firstname"),i=t("#coc-register-privacy")[0].checked;!0===u?null!=l&&r.append("image",l[0]):r.append("imageUrl",t("#coc-image").attr("src")),r.append("firstname",s.val()),r.append("lastname",t("#coc-lastname").val()),r.append("email",o.val()),r.append("message",c.val()),r.append("country",t("#coc-country").val()),r.append("anon",t("#coc-anon")[0].checked),r.append("beta","0"),r.append("nl",t("#coc-register-nl")[0].checked),r.append("pr",i),t.urlParam=function(a){var t=new RegExp("[?&]"+a+"=([^&#]*)").exec(e.location.search);return null==t?0:t[1]||0},r.append("pax",t.urlParam("pax")),t.ajax({url:cocVars.ajax_url+"coc/v2/createEntry/",method:"POST",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",cocVars.nonce)},success:function(a){null!==a&&!0===a.success?(new PNotify({title:"Das hat geklappt!",text:"DANKE, dass DU dabei bist. JEDER EINZELNE ZÄHLT! Bitte bestätige jetzt Deine Emailadresse.",addclass:"stack-bottomright",stack:{dir1:"up",dir2:"left",push:"top"}}),n.toggleForm(),setTimeout((function(){e.location.reload()}),3e3)):(null!==a&&Object.keys(a).forEach((function(e){"success"===e&&"error"===e||t("#"+g[e])&&(t("#"+g[e]).addClass("input-error"),(t("#"+g[e]).next().length?t("#"+g[e]).next():t("#"+g[e])).after('<p class="form-error-hint">'+a[e]+"</p>"))})),new PNotify({title:"Ups! Das geht schief!",text:"Bitte probiere es erneut!",addclass:"stack-bottomright",stack:{dir1:"up",dir2:"left",push:"top"}}))},data:r,cache:!1,dataType:"json",processData:!1,contentType:!1})})),t(".user-image").on("click",f),t(".close-wrapper").find(".fa-times").on("click",(function(){s.hide()})),t("#loadMore").on("click",(function(e){d+=1;var a={};a.offset=d,a.profileImage=t("#profileImage").prop("checked")?1:0,a.orderByDate="asc"===t("#orderByDate").val()?"asc":"desc",t.ajax({url:cocVars.ajax_url+"coc/v2/getEntries/?"+t.param(a),method:"GET",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",cocVars.nonce)},success:function(e){if(e.length<81&&t("#loadMore").hide(),e.length>0){for(var a=0;a<e.length;a++){var n=e[a],r=n.firstname,o=n.message,s=""===n.image?cocVars.homeUrl+"/wp-content/plugins/coc/assets/images/coc-placeholder.jpg":n.image,i=n.country,l='<img class="user-image" data-anon="'+n.anon+'" data-uname="'+r+'" data-message="'+o+'" data-country="'+i+'" style="width:100%;margin-top:5px;" alt="signer-image" src="'+s+'" />';t(".user-container").append('<div class="user-item">'+l+"</div>"),c.push(l)}t(".user-image").on("click",f)}else t("#loadMore").hide()},cache:!1}),e.preventDefault()})),t("#profileImage, #orderByDate").on("change",(function(e){var a={};a.profileImage=t("#profileImage").prop("checked")?1:0,a.orderByDate="asc"===t("#orderByDate").val()?"asc":"desc",t.ajax({url:cocVars.ajax_url+"coc/v2/getEntries/?"+t.param(a),method:"GET",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",cocVars.nonce)},success:function(e){if(e.length<81&&t("#loadMore").hide(),e.length>0){t(".user-container").html("");for(var a=0;a<e.length;a++){var n=e[a],r=n.firstname,o=n.message,s=""===n.image?cocVars.homeUrl+"/wp-content/plugins/coc/assets/images/coc-placeholder.jpg":n.image,i=n.country,l='<img class="user-image loaded" data-anon="'+n.anon+'" data-uname="'+r+'" data-message="'+o+'" data-country="'+i+'" style="width:100%;margin-top:5px;" alt="signer-image" src="'+s+'" />';t(".user-container").append('<div class="user-item">'+l+"</div>"),c.push(l)}t(".user-image").on("click",f)}else t("#loadMore").hide()},cache:!1}),e.preventDefault()})),t("#prevMessage").on("click",n.prevMessage),t("#nextMessage").on("click",n.nextMessage),n.ownImageChangeHandler(),t("#country-rankings-load-more .load-more-link").on("click",(function(e){e.preventDefault(),t(".country-ranking-item.hidden").slice(0,12).each((function(e,a){t(a).removeClass("hidden")})),0===t(".country-ranking-item.hidden").length&&t("#country-rankings-load-more").hide(),setTimeout((function(){t([a.documentElement,a.body]).animate({scrollTop:t("#country-rankings-load-more").offset().top},1e3)}),150)}))},t(e).off("keyup").on("keyup",(function(e){27===e.which&&(n.closeForm(),n.closeUserOverlay()),37===e.which&&n.prevMessage(),39===e.which&&n.nextMessage()})),n.toggleForm=function(){"block"===r.css("display")?r.hide():r.show()},n.resetForm=function(){},n.closeForm=function(){r.hide()},n.resetForm=function(){},n.closeUserOverlay=function(){s.hide()},n.loadCountryFlagImage=function(e){var a=s.find(".message-country");if(a.html(""),2===e.length){var t=cocVars.homeUrl+"/wp-content/plugins/coc/assets/images/flags/"+e.toLowerCase()+".png",r=n.getCountryNameByCountryCode(e);a.addClass("loaded"),a.html('<img src="'+t+'" title="Eintrag kommt aus '+r+'" alt="Eintrag kommt aus '+r+'" height="35">')}},n.loadCountries=function(){t.getJSON(cocVars.homeUrl+"/wp-content/plugins/coc/assets/js/countries.json",(function(e){n.countries=e}))},n.getCountryNameByCountryCode=function(e){return e.toUpperCase(),e in n.countries?n.countries[e]:""},n.prevMessage=function(){i<=0?i=c.length-1:i--;var e=t(c[i]),a=e.data("message");""===a&&(a=o),s.find(".user-message-image").attr("src",e[0].src),s.find(".message-text").text(a);var r=e.data("uname");1===e.data("anon")&&(r="Mensch"),s.find(".message-name").text(r);var l=e.data("country");n.loadCountryFlagImage(l)},n.nextMessage=function(){i>=c.length-1?i=0:i++;var e=t(c[i]),a=e.data("message");""===a&&(a=o),s.find(".user-message-image").attr("src",e[0].src),s.find(".message-text").text(a);var r=e.data("uname");1===e.data("anon")&&(r="Mensch"),s.find(".message-name").text(r);var l=e.data("country");n.loadCountryFlagImage(l)},t(a).ready(n.init),n}(window,document,jQuery)}]);